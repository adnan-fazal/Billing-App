<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Billing Web App - Manage Items</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Navigation Bar -->
    <nav>
        <a href="index.html" class="logo">üçî Billing App</a>
        <ul class="nav-links">
            <li><a href="index.html">Home</a></li>
            <li><a href="manage-items.html">Manage Items</a></li>
            <li><a href="invoice-history.html">Invoice History</a></li>
            <li>
                <a href="cart.html" class="cart-link">
                    üõí Cart
                    <span id="cart-badge" class="badge"></span>
                </a>
            </li>
        </ul>
    </nav>

    <!-- Main Content -->
    <div class="container">
        <h1 class="page-title">Manage Menu Items</h1>
        
        <!-- Form for adding/editing items -->
        <div class="form-container">
            <h2 id="form-title">Add New Item</h2>
            <form id="item-form" onsubmit="handleSubmit(event)">
                <input type="hidden" id="item-id">
                <div class="form-group">
                    <label for="item-name">Item Name</label>
                    <input type="text" id="item-name" required placeholder="Enter item name">
                </div>
                <div class="form-group">
                    <label for="item-price">Price</label>
                    <input type="number" id="item-price" step="0.01" min="0" required placeholder="Enter price">
                </div>
                <div class="form-group">
                    <label for="item-image">Image URL</label>
                    <input type="url" id="item-image" required placeholder="Enter image URL">
                </div>
                <div class="form-actions">
                    <button type="submit" class="btn btn-primary" id="submit-btn">Add Item</button>
                    <button type="button" class="btn btn-secondary" id="cancel-btn" onclick="resetForm()" style="display: none;">Cancel</button>
                </div>
            </form>
        </div>

        <!-- Items Table -->
        <div id="items-table-container">
            <!-- Items table will be dynamically loaded here -->
        </div>
    </div>

    <script src="app.js"></script>
    <script>
        let editingId = null;

        // Load and display items
        function loadItems() {
            const items = getMenuItems();
            const container = document.getElementById('items-table-container');

            if (items.length === 0) {
                container.innerHTML = '<div class="empty-state"><h2>No items available</h2><p>Add your first item using the form above</p></div>';
                return;
            }

            let html = `
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Image</th>
                                <th>Name</th>
                                <th>Price</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
            `;

            items.forEach(item => {
                html += `
                    <tr>
                        <td><img src="${item.image}" alt="${item.name}" class="table-image" onerror="this.src='https://via.placeholder.com/60?text=No+Image'"></td>
                        <td>${item.name}</td>
                        <td>$${item.price.toFixed(2)}</td>
                        <td>
                            <button class="btn btn-secondary btn-small" onclick="editItem('${item.id}')">Edit</button>
                            <button class="btn btn-danger btn-small" onclick="deleteItem('${item.id}')">Delete</button>
                        </td>
                    </tr>
                `;
            });

            html += `
                        </tbody>
                    </table>
                </div>
            `;

            container.innerHTML = html;
        }

        // Handle form submit
        function handleSubmit(event) {
            event.preventDefault();
            
            const name = document.getElementById('item-name').value;
            const price = document.getElementById('item-price').value;
            const image = document.getElementById('item-image').value;
            const id = document.getElementById('item-id').value;

            if (editingId) {
                // Update existing item
                updateMenuItem(editingId, name, price, image);
            } else {
                // Create new item
                createMenuItem(name, price, image);
            }

            resetForm();
            loadItems();
        }

        // Edit item
        function editItem(id) {
            const items = getMenuItems();
            const item = items.find(i => i.id === id);
            
            if (!item) return;

            editingId = id;
            document.getElementById('item-id').value = id;
            document.getElementById('item-name').value = item.name;
            document.getElementById('item-price').value = item.price;
            document.getElementById('item-image').value = item.image;
            document.getElementById('form-title').textContent = 'Edit Item';
            document.getElementById('submit-btn').textContent = 'Update Item';
            document.getElementById('cancel-btn').style.display = 'inline-block';

            // Scroll to form
            document.querySelector('.form-container').scrollIntoView({ behavior: 'smooth' });
        }

        // Delete item
        function deleteItem(id) {
            if (!confirm('Are you sure you want to delete this item?')) {
                return;
            }

            deleteMenuItem(id);
            loadItems();
        }

        // Reset form
        function resetForm() {
            editingId = null;
            document.getElementById('item-form').reset();
            document.getElementById('item-id').value = '';
            document.getElementById('form-title').textContent = 'Add New Item';
            document.getElementById('submit-btn').textContent = 'Add Item';
            document.getElementById('cancel-btn').style.display = 'none';
        }

        // Initialize page
        document.addEventListener('DOMContentLoaded', () => {
            initializeNavigation();
            loadItems();
        });
    </script>
</body>
</html>

